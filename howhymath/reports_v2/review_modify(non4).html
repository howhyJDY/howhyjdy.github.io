<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <title>하와이매쓰</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

    <!-- favicon -->
    <link rel="shortcut icon" href="https://img.howhymath.com/hmath/favicon.ico">
    <!-- base css -->
    <link rel="stylesheet" type="text/css" href="https://img.dtsoft.co.kr/assets.howhy/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://img.dtsoft.co.kr/assets.howhy/css/icons.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://img.dtsoft.co.kr/assets.howhy/css/metisMenu.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://img.dtsoft.co.kr/assets.howhy/css/app.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote-lite.min.css"/>
    <!-- site css -->
    <link rel="stylesheet" type="text/css" href="https://img.dtsoft.co.kr/cdml/cdml.css?v=1734673801"/>
    <link rel="stylesheet" type="text/css" href="https://img.dtsoft.co.kr/fx/fx.v2.css?v=1734673801"/>
    <!-- link rel="stylesheet" type="text/css" href="https://img.howhymath.com/custom/custom.css?v=1734673801" /-->
    <!-- <link rel="stylesheet" type="text/css" href="/app//css/work.css?v=1734673801"/> -->
    <link rel="stylesheet" type="text/css" href="../assets/css/work.css"/>
    <!-- base javascript -->
    <script src="https://img.dtsoft.co.kr/assets.howhy/js/jquery.min.js"></script>
    <script src="https://img.dtsoft.co.kr/assets.howhy/js/bootstrap.bundle.min.js"></script>
    <script src="https://img.dtsoft.co.kr/assets.howhy/js/metismenu.min.js"></script>
    <script src="https://img.dtsoft.co.kr/assets.howhy/js/waves.js"></script>
    <script src="https://img.dtsoft.co.kr/assets.howhy/js/feather.min.js"></script>
    <script src="https://img.dtsoft.co.kr/assets.howhy/js/simplebar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote-lite.min.js"></script>
    <!-- site javascript -->
    <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                showMathMenu: false,
                tex2jax: { displayMath: [ ["$$","$$"] ] },
                "HTML-CSS": { fonts: ["Latin-Modern"] }
            });
        </script>
    <script type="text/javascript" src="https://img.dtsoft.co.kr/mathjax/MathJax.js?config=TeX-AMS_HTML"></script>
    <script type="text/javascript" src="https://img.dtsoft.co.kr/fx/fx.v2.js?v=1734673801"></script>
    <script type="text/javascript" src="https://img.dtsoft.co.kr/cdml/cdml.js?v=1734673801"></script>
    </head>
    <script>
    cdml_img_url = "https://img.dtsoft.co.kr/cdml/img/";
    cdml_api_url = "https://tutor.howhymath.com/lms_api/questions";
    var lms_domain = "https://tutor.howhymath.com";
    </script>

<body data-layout="horizontal">
    <div style="display:none">$$\require{cancel}$$</div>
    <div class="page-wrapper" style="padding:0;width:100% !important;">
        <div class="page-content">
            <div class="container-fluid">               
                <!-- 240401 리포트 전용 인쇄관련 css 추가-->
                <link rel="stylesheet" type="text/css" href="../assets/css/report_print.css"/>

                <div class="review-input-container">
                    <div class="review-student-list">
                        <strong>학생선택</strong>
                        <ul>
                            <!-- 현재 학생 클래스 on -->
                            <li data-idx="1"><button type="button" onclick="load_report_box(1);">초5/이하와(2025-03)</button></li>
                            <li data-idx="2"><button type="button" onclick="load_report_box(2);">초5/홍길동(2025-03)</button></li>
                            <li data-idx="3"><button type="button" onclick="load_report_box(3);">초4/김하와(2025-03)</button></li>
                            <li data-idx="4"><button type="button" onclick="load_report_box(4);">초6/장하와(2025-02)</button></li>
                        </ul>
                    </div>

                    <!-- 미리보기 화면 시작 -->
                    <div class="review-bottom" id="review-preview-area">
                        <div class="preview-wrap">
                            <div class="preview-content">
                                <section class="print-page report-page6">
                                    <div class="row page-header">
                                        <div class="col">
                                            <strong>5</strong>
                                            <h2>학습 종합 보고서</h2>
                                            <p>학생의 수업 태도와 학습 과정에서의 변화를 세심히 살펴 알려드립니다. 본 원에서는 담당 교사가 학생의 학습 상황을 지속적으로 관찰하며, 보다 적극적으로 참여를 유도하고, 개인별 특성과 상황에 맞게 지도 하고 있습니다.</p>
                                        </div>
                                    </div>
    
                                    <div class="row page-content">
                                        <div class="col">
                                            <div class="grid">
                                                <div class="grid-item item1">
                                                    <span class="img-greetings"></span>
                                                    <div class="txt">
                                                        <textarea class="textarea maxLength" data-max="120" name="inp-review1" id="inp-review1"></textarea>
                                                    </div>
                                                </div>
                                                <div class="grid-item-wrap">
                                                    <dl class="grid-item item2 disabled">
                                                    <!-- 리포트 생성 시 '사용하지 않음' 체크한 경우 해당 item에 클래스 disabled 추가
                                                    <dl class="grid-item item2 disabled"> -->
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="성취도의 변화"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review2" id="inp-review2">헌법에 의하여 체결·공포된 조약과 일반적으로 승인된 국제법규는 국내법과 같은 효력을 가진다. 대통령은 필요하다고 인정할 때에는 외교·국방·통일 기타 국가안위에 관한 중요정책을 국민투표에 붙일 수 있다. 법원은 최고법</textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item3 disabled">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="수업을 따라오는 정도"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review3" id="inp-review3"></textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item4 ">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="수업 중 학습에 대한 태도"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review4" id="inp-review4"></textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item5">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="수업 중 참여도"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review5" id="inp-review5"></textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item6 disabled">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="자기주도 학습 태도"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review6" id="inp-review6"></textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item7 disabled">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="학생의 정서적인 상태"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review7" id="inp-review7"></textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item8">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="교사와의 관계"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review8" id="inp-review8"></textarea>
                                                        </dd>
                                                    </dl>
                                                    <dl class="grid-item item9">
                                                        <dt><input type="text" maxlength="20" placeholder="20자 이내로 작성해주세요." value="질문에 대한 반응"></dt>
                                                        <dd class="txt">
                                                            <textarea class="textarea maxLength noEnter" data-max="120" name="inp-review9" id="inp-review9"></textarea>
                                                        </dd>
                                                    </dl>
                                                </div>
                                                <div class="grid-item item10">
                                                    <div class="txt">
                                                        <textarea class="textarea maxLength" data-max="240" name="inp-review10" id="inp-review10"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="grid-footer"><strong>담당교사 홍길동</strong> 드림</p>
                                        </div>
                                    </div>
                                    <!-- //page-content -->
                                </section>
                            </div>
                        </div>

                        <div class="btn-box">
                            <button type="button" class="btn-cancel">취소</button>
                            <button type="button" class="btn-save">저장</button>
                        </div>
                    </div>
                    <!-- 미리보기 화면 끝 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        $( document ).ready(function() {
            itemNumberChk();
            addPlaceholder();
        })

        /* 학생 변경 */
        function load_report_box( idx ){
            location.href="./review_modify.html?ids=199&idx=" + idx;
        }
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }
        document.addEventListener("DOMContentLoaded", function () {
            const idx = getQueryParam("idx");
            document.querySelectorAll(`.review-student-list li`).forEach(li => {
                li.classList.remove('on');
            });
            if (idx) {
                const targetLi = document.querySelector(`li[data-idx="${idx}"]`);
                if (targetLi) targetLi.classList.add("on");
            }else{
                document.querySelector(`.review-student-list li`).classList.add("on");
            }
        });

        const gridItemAll = document.querySelectorAll('.grid-item');
        const textarea10 = document.getElementById('inp-review10');

        /* grid-item 개수에 따라 맺음말 텍스트 제한 변경 */
        function itemNumberChk(){
            
            let itemDisabledLength = [...gridItemAll].filter(v => v.classList.contains('disabled')).length;
            switch (itemDisabledLength) {
                case 2:
                    textarea10.closest('.item10').style.height = '205px';
                    textarea10.dataset.max = 500;
                    break;
                case 4:
                    textarea10.closest('.item10').style.height = '310px';
                    textarea10.setAttribute.placeholder = ''
                    textarea10.dataset.max = 750;
                    break;
                default:
                    textarea10.closest('.item10').style.height = '105px';
                    textarea10.dataset.max = 240;
                    break;
            }
        }

        /* texatea placeholder 자동 입력 */
        function addPlaceholder() {
            [...gridItemAll].forEach(v => {
                let textarea = v.querySelector('textarea');
                let max = textarea.dataset.max;
                textarea.setAttribute('placeholder',`${max}자 이하로 작성해주세요.`);
            });
        }

        /* textarea 한글 입력 글자 수 제한 */
        document.querySelectorAll('.maxLength').forEach(item => {
            const limit = parseInt(item.dataset.max, 10) || 120; // 기본값 120

            const sanitizeAndTrim = (value, limit) => {
                const plainText = value.replace(/<[^>]*>/g, '');
                return plainText.length > limit ? plainText.substring(0, limit) : plainText;
            };

            const showError = () => {
                item.classList.add('error');
                setTimeout(() => item.classList.remove('error'), 1000);
            };

            const validate = () => {
                const limit = parseInt(item.dataset.max, 10) || 120;
                const trimmed = sanitizeAndTrim(item.value, limit);
                if (trimmed !== item.value) {
                    item.value = trimmed;
                    showError();
                }
            };

            item.addEventListener('input', (e) => {
                if (!e.isTrusted) return;

                validate();

                // 줄 수 제한 (스크롤 높이 기준)
                while (item.scrollHeight > item.clientHeight) {
                    item.value = item.value.slice(0, -1);
                }
            });

            // 줄바꿈 제한
            if (item.classList.contains('noEnter')) {
                item.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') e.preventDefault();
                });
            }

            validate(); // 초기 유효성 검사
        });
    </script>
</body>
</html>